(()=>{let e=document.getElementById("listaRestaurantes"),t=document.getElementById("contedorLista"),a=!1,n=localStorage.getItem("counter")?parseInt(localStorage.getItem("counter")):0;const r=[];"geolocation"in navigator&&navigator.geolocation.getCurrentPosition((function(o){const l=L.map("mapa").setView([42.78493742707595,-7.727758789062501],8);function i(t){t.preventDefault();let o=document.createElement("li");o.classList.add("m-1"),o.id=`marcador${n}`,o.innerHTML=`<b>Nombre: </b>${t.currentTarget.firstElementChild.value} - <b>Género: </b>${t.currentTarget.children[1].value}`,o.style.backgroundImage="linear-gradient(to right, lightblue, white, lightblue)",o.style.cursor="pointer",e.prepend(o);let i=document.createElement("button");i.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash-fill" viewBox="0 0 16 16"><path d="M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1H2.5zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5zM8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5zm3 .5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 1 0z"/></svg>',i.classList.add("btn","btn-danger","ms-4"),i.addEventListener("click",c),o.append(i);const{latitude:d,longitude:u}=JSON.parse(localStorage.getItem(`marcador${n}`));s(d,u).then((function(e){let t=document.createElement("div");t.classList.add("row","text-center");let[a,n]=e,r=document.createElement("p");r.textContent=`${n.split("T")[0]}  ${n.split("T")[1]} h`,r.classList.add("col-6","h5");let l=document.createElement("p");l.textContent=`${a} ºC`,l.classList.add("col-6","h5"),t.append(r),t.append(l),o.append(t)}));const m=L.marker([d,u]);m.addTo(l),m.bindPopup(`<b>Nombre: </b>${t.currentTarget.firstElementChild.value}\n<b>Género: </b>${t.currentTarget.children[1].value}`).openPopup(),localStorage.setItem(`marcador${n}`,JSON.stringify({latitude:d,longitude:u,desc:`<b>Nombre: </b>${t.currentTarget.firstElementChild.value} - <b>Género: </b>${t.currentTarget.children[1].value}`})),r.push(m),t.currentTarget.remove(),a=!1}function c(e){if("BUTTON"===e.currentTarget.tagName){let t=e.target.closest("li"),a=r[parseInt(t.id.substr(t.id.length-1))-1];console.log(r),r[parseInt(t.id.substr(t.id.length-1))-1]=null,a.remove(),t.remove(),localStorage.setItem(t.id,""),console.log(r)}}async function s(e,t){let a,n=await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${e}&longitude=${t}&hourly=temperature_2m&current_weather=true&timezone=Europe%2FLondon&start_date=2023-02-02&end_date=2023-02-02`);return!!n.ok&&(a=await n.json(),[a.current_weather.temperature,a.current_weather.time])}L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:"Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community"}).addTo(l),function(){for(chave of Object.keys(localStorage).sort())if("IsThisFirstTime_Log_From_LiveServer"!==chave&&"counter"!==chave)if(""!==localStorage.getItem(chave)){const{latitude:t,longitude:a,desc:n}=JSON.parse(localStorage.getItem(chave));let o=document.createElement("li");o.classList.add("m-1"),o.id=chave,o.innerHTML=n,o.style.cursor="pointer",o.style.backgroundImage="linear-gradient(to right, lightblue, white, lightblue)",e.prepend(o);let i=document.createElement("button");i.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash-fill" viewBox="0 0 16 16"><path d="M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1H2.5zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5zM8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5zm3 .5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 1 0z"/></svg>',i.classList.add("btn","btn-danger","ms-5"),i.addEventListener("click",c),o.append(i),s(t,a).then((function(e){let t=document.createElement("div");t.classList.add("row","text-center");let[a,n]=e,r=document.createElement("p");r.textContent=`${n.split("T")[0]}  ${n.split("T")[1]} h`,r.classList.add("col-6","h5");let l=document.createElement("p");l.textContent=`${a} ºC`,l.classList.add("col-6","h5"),t.append(r),t.append(l),o.append(t)}));const d=L.marker([t,a]);d.addTo(l),d.bindPopup(n).openPopup(),r.push(d)}else r.push(null)}(),l.on("click",(function(e){let r=e.latlng.lat,o=e.latlng.lng;if(!a){let e=document.createElement("form");e.action="",e.method="POST",e.addEventListener("submit",i);let l=document.createElement("input");l.type="text",l.placeholder="Nombre",l.classList.add(["col-5","form-control"]);let c=document.createElement("input");c.type="text",c.placeholder="Género",c.classList.add(["col-5","form-control"]);let s=document.createElement("button");s.type="submit",s.hidden=!0,e.append(l),e.append(c),e.append(s),t.append(e),a=!0,l.focus(),n++,localStorage.setItem("counter",n),localStorage.setItem(`marcador${n}`,JSON.stringify({latitude:r,longitude:o}))}})),e.addEventListener("click",(function(e){if("BUTTON"!==e.target.tagName&&"svg"!==e.target.tagName&&"path"!==e.target.tagName){let t=e.target.closest("li");const{latitude:a,longitude:n}=JSON.parse(localStorage.getItem(t.id));l.closePopup(),l.flyTo([a,n],17),r[parseInt(t.id.substr(t.id.length-1))-1].openPopup()}}))}))})();
//# sourceMappingURL=index.js.map
